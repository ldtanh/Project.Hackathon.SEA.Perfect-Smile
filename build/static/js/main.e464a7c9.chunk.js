(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){e.exports=n.p+"static/media/downArrow.ee80dd4b.png"},101:function(e,t,n){e.exports=n.p+"static/media/leftArrow.a0858f6e.png"},102:function(e,t,n){e.exports=n.p+"static/media/rightArrow.5e5705ec.png"},103:function(e,t,n){e.exports=n.p+"static/media/spritesheet.1f93086c.png"},104:function(e,t,n){e.exports=n.p+"static/media/itg_arrow_good_400x400.c3128bf8.png"},105:function(e,t,n){e.exports=n.p+"static/media/topExplosion.7f0ea168.png"},106:function(e,t,n){e.exports=n.p+"static/media/bottomExplosion.95f0ab71.png"},107:function(e,t,n){e.exports=n.p+"static/media/leftExplosion.0385c4aa.png"},108:function(e,t,n){e.exports=n.p+"static/media/logo.815eb85e.png"},110:function(e,t,n){e.exports=n(217)},115:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){},124:function(e,t){},126:function(e,t){},160:function(e,t){},161:function(e,t){},203:function(e,t){},204:function(e,t){},205:function(e,t){},206:function(e,t){},207:function(e,t){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},214:function(e,t,n){},215:function(e,t,n){},216:function(e,t,n){},217:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(97),i=n.n(o),c=(n(115),n(8)),s=n(9),l=n(12),u=n(10),m=n(11),p=(n(116),n(98)),d=n.n(p),f=(n(117),function(){return r.a.createElement("div",{className:"background-video"},r.a.createElement("video",{autoPlay:!0,loop:!0,id:"bg-video"},r.a.createElement("source",{src:d.a,type:"video/mp4"})),r.a.createElement("div",{className:"background-video-bg"}))}),h=(n(118),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).interval=null,n.state={time:0},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){e.setState({time:e.state.time+1})},1e3)}},{key:"render",value:function(){return r.a.createElement("div",{className:"play-time"},r.a.createElement("span",{className:"title"},"TIME"),r.a.createElement("span",{className:"time"},[(e=this.state.time)%3600/60,e%60].map(function(e){return"0".concat(Math.floor(e)).slice(-2)}).join(":")));var e}}]),t}(r.a.PureComponent)),v=n(13),g=n.n(v),b=n(19),y=n(25),E=n(37),w=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(){var e=Object(E.a)(n),t=e.video,a=e.overlay,r=e.isLoaded;if(t&&a&&r){var o=n.video.getBoundingClientRect(),i=o.width,c=o.height;n.overlay.width=i,n.overlay.height=c,n.props.onLoaded({mediaElement:t,overlay:a})}},n.onVideoRef=function(e){n.video=e,n.props.onVideoRef&&n.props.onVideoRef(),n.onChange()},n.onCanvasRef=function(e){n.overlay=e,n.onChange()},n.onPlay=function(){n.isLoaded=!0,n.onChange()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.srcObject;t&&this.props.srcObject!==t&&(this.video.srcObject=t)}},{key:"shouldComponentUpdate",value:function(e){return e.src!==this.props.src}},{key:"componentDidUpdate",value:function(){this.onChange()}},{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){return a.createElement("div",{style:{position:"relative"}},a.createElement("video",{muted:!0,autoPlay:!0,style:Object.assign({},this.props.videoStyle),ref:this.onVideoRef,onPlay:this.onPlay,src:this.props.src,className:"video-element"}),a.createElement("canvas",{style:{position:"absolute",top:0,left:0},ref:this.onCanvasRef}))}}]),t}(a.Component),O=(n(209),function e(){var t=this;Object(c.a)(this,e),this.promise=new Promise(function(e,n){t.reject=n,t.resolve=e})}),R=n(109),T={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right"},j={UNSET:0,EASY:1,MEDIUM:2,HARD:3},S=Object(R.a)(Array(500)),k=function(){var e=Math.random();return e<.25?T.UP:e<.5?T.DOWN:e<.75?T.LEFT:T.RIGHT},x=S.map(function(){return{type:k(),nextArrowStartTime:Math.max(2e3*Math.random(),2e3)}}),N=1e3,C=500,F=300,D=4,P=.01,A=.5,M=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={listFrames:[],faceDetectionOptions:new y.a,isFirstFaceDetected:!1},n.listComingDirection=[],n.directionId=0,n.loadFaceDetector=Object(b.a)(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=y.c.tinyFaceDetector).isLoaded||(console.log("Reload Model: ",t),t.loadFromUri("./models")),n.setState({isFaceDetectorLoaded:!0});case 3:case"end":return e.stop()}},e)})),n.runFaceRecognition=Object(b.a)(g.a.mark(function e(){var t,a,r,o,i;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,a=t.mediaElement,r=t.overlay,o=t.faceDetectionOptions,a&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,y.b(a,o).withFaceExpressions();case 5:(i=e.sent)?n.onReceivedNextFrame(i):n.setState({somethingDummy:Math.random()});case 7:case"end":return e.stop()}},e)})),n.onVideoRef=Object(b.a)(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:{}});case 3:t=e.sent,n.setState({srcObject:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n.setState({error:e.t0.toString()});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),n.checkLastMovingFrame=function(e,t){var a=n.state.listFrames;if(a.length<1)return!0;var r=a[a.length-1],o=r.x,i=r.y;return!(Math.abs(e-o)<P)&&!(Math.abs(t-i)<P)},n.checkDirectionWithTimeout=function(e,t){var a=new O,r=a.resolve,o=a.promise,i=++n.directionId;return setTimeout(function(){n.listComingDirection=n.listComingDirection.filter(function(e){return e.id!==i}),r({isValid:!1,happyValue:null})},t),n.listComingDirection.push({resolve:r,type:e,id:i}),o},n.onReceivedNextFrame=function(e){var t=e.detection,a=e.expressions.happy;a<A&&console.log("Unhappy!!! Rate: ".concat(100*a," %"));var r=t.box,o=r.x,i=r.y;if(n.checkLastMovingFrame(o,i)){var c=n.state.listFrames;if(c.length===D){var s=c[0],l=s.x,u=s.y,m=Math.abs(o-l),p=Math.abs(i-u),d=T.LEFT;m>p?o<l&&(d=T.RIGHT):d=i<u?T.UP:T.DOWN;var f=n.listComingDirection.filter(function(e){return e.type===d});f.length>0&&(f[0].resolve({isValid:!0,happyValue:a}),n.listComingDirection=n.listComingDirection.filter(function(e){return e.id!==f[0].id})),n.setState({listFrames:[{x:o,y:i}]})}else c.push({x:o,y:i}),n.setState({listFrames:c})}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"loadModels",value:function(){var e=Object(b.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([y.c.faceExpressionNet.loadFromUri("./models"),y.c.tinyFaceDetector.loadFromUri("./models")]);case 2:return e.next=4,this.loadFaceDetector();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.loadModels()}},{key:"componentDidUpdate",value:function(){this.runFaceRecognition()}},{key:"render",value:function(){var e=this;return this.state.error?a.createElement("div",{style:{background:"red",color:"white"}},a.createElement("h3",null," Error occured while requesting webcam access: "),a.createElement("p",null," ",this.state.error," ")):a.createElement("div",{className:"webcam-container"},a.createElement(w,{srcObject:this.state.srcObject,onLoaded:function(t){return e.setState(t)},onVideoRef:this.onVideoRef,onReceivedNextFrame:this.onReceivedNextFrame}))}}]),t}(a.Component),I=n(39),U=n(40),L=n(99),H=n.n(L),V=n(100),G=n.n(V),W=n(101),B=n.n(W),_=n(102),q=n.n(_),J=function e(t){var n=t.element,a=t.frames,r=t.duration,o=void 0===r?600:r,i=t.columns,s=t.rows,l=t.startingPosition,u=void 0===l?null:l,m=t.iterations,p=void 0===m?1/0:m;Object(c.a)(this,e),this.element=n,this.frames=a,this.duration=o/a,this.columns=i,this.rows=s,this.startingPosition=u,this.iterations=p,this.animateSprite=function(){var e=this.element,t=this.startingPosition,n=this.columns,a=this.rows,r=this.duration,o=this.iterations,i=document.querySelector(".".concat(e)),c=i.dataset.animationSrc,s=0,l=0,u=0;"bottom-right"===t&&(l=100,u=100),i.style.background="url(".concat(c,") ").concat(l,"% ").concat(u,"%"),i.style.backgroundSize="".concat(100*n,"% ").concat(100*a,"%"),requestAnimationFrame(function e(c){if(c-s<r)return void requestAnimationFrame(e);s=c;i.style.backgroundPosition="".concat(l,"% ").concat(u,"%");null===t?(l<100?l+=100/(n-1):(l=0,u>=100?(u=0,o&&o>0&&o--):u+=100/(a-1)),o>0&&requestAnimationFrame(e)):"bottom-right"===t&&(l>0?l-=100/(n-1):(l=100,u>0?u-=100/(a-1):(u=100,o&&o>0&&o--)),o>0&&requestAnimationFrame(e))})}},z=n(103),K=n.n(z),Y=n(104),$=n.n(Y),Q=n(105),X=n.n(Q),Z=n(106),ee=n.n(Z),te=n(107),ne=n.n(te),ae={TOP:"top",LEFT:"left",RIGHT:"right",BOTTOM:"bottom"},re=80,oe={width:re,height:re},ie={width:re+80,height:re+80,position:"relative",top:-(re+20)},ce=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getRotateAngle=function(){switch(n.props.direction){case ae.TOP:return 180;case ae.LEFT:return 90;case ae.RIGHT:return-90;default:return 0}},n.getExplosionIcon=function(){switch(n.props.direction){case ae.TOP:return X.a;case ae.LEFT:return ne.a;case ae.RIGHT:return K.a;default:return ee.a}},n.getRowOfSprite=function(){switch(n.props.direction){case ae.TOP:return 7;case ae.LEFT:case ae.RIGHT:return 9;default:return 8}},n.boom=function(){n._animationOne.animateSprite()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._animationOne=new J({element:"image-".concat(this.props.direction),frames:60,columns:10,rows:this.getRowOfSprite(),iterations:1})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("img",{src:$.a,style:Object(U.a)({},oe,{transform:"rotate(".concat(this.getRotateAngle(),"deg)")})})),r.a.createElement("div",{style:ie,className:"image-".concat(this.props.direction),"data-animation-src":this.getExplosionIcon()}))}}]),t}(a.Component),se=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._onReachTop=Object(b.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.onReachTop();case 2:e.sent&&n.setState({scale:0});case 4:case"end":return e.stop()}},e)})),n.getImageSource=function(){switch(n.props.type){case T.UP:return H.a;case T.LEFT:return B.a;case T.RIGHT:return q.a;default:return G.a}},n.state={bottom:-re,scale:1},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.isStart,r=n.distance,o=n.moveTime;a&&!e.isStart&&this.setState({bottom:r},function(){return setTimeout(t._onReachTop,o-N/2)})}},{key:"render",value:function(){var e=this.props.moveTime,t=this.state,n=t.bottom,a=t.scale;return r.a.createElement("img",{src:this.getImageSource(),alt:"up-icon",className:"arrow-item",style:{transition:"bottom ".concat(e/1e3,"s linear, opacity 0.2s, transform 0.2s"),bottom:n,transform:"scale(".concat(a,")"),opacity:a,width:re,height:re}})}}]),t}(r.a.Component),le=(n(210),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).leftRef=r.a.createRef(),n.downRef=r.a.createRef(),n.upRef=r.a.createRef(),n.rightRef=r.a.createRef(),n._preProcessingData=function(){var e=n.props.arrows,t=0;return e.map(function(e,n){var a={id:n,type:e.type,timeoutStartTime:t};return t+=e.nextArrowStartTime,a})},n.start=function(){n.state.data.forEach(function(e){setTimeout(function(){return n.animateArrow(e)},e.timeoutStartTime)})},n.animateArrow=function(e){n.setState({isAnimatedMap:Object(U.a)({},n.state.isAnimatedMap,Object(I.a)({},e.id,!0))})},n.handleBoom=function(e){switch(e){case T.UP:n.upRef.current&&n.upRef.current.boom();break;case T.DOWN:n.downRef.current&&n.downRef.current.boom();break;case T.LEFT:n.leftRef.current&&n.leftRef.current.boom();break;case T.RIGHT:n.rightRef.current&&n.rightRef.current.boom()}},n.handleReachTop=function(){var e=Object(b.a)(g.a.mark(function e(t,a){var r,o,i,c,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Date.now(),n.props.webcam.current){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.props.webcam.current.checkDirectionWithTimeout(a,N);case 5:return o=e.sent,i=o.isValid,o.happyValue,i&&(c=Date.now(),(s=c-r)<=N/3||s>2*N/3?n.props.onScoreChange(F):n.props.onScoreChange(C),n.handleBoom(a)),e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.state={data:n._preProcessingData(n.props.arrows),isAnimatedMap:{}},setTimeout(function(){return n.forceUpdate()},100),setTimeout(n.start,500),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.data,a=t.isAnimatedMap,o=this.props.moveTime,i=document.getElementById("arrow-game"),c=n.filter(function(e){return e.type===T.UP}),s=n.filter(function(e){return e.type===T.DOWN}),l=n.filter(function(e){return e.type===T.LEFT}),u=n.filter(function(e){return e.type===T.RIGHT});return r.a.createElement("div",{className:"arrow-game-wrapper",id:"arrow-game"},r.a.createElement("div",{className:"arrow-holder-wrapper"},r.a.createElement(ce,{ref:this.leftRef,direction:ae.LEFT}),r.a.createElement(ce,{ref:this.downRef,direction:ae.BOTTOM}),r.a.createElement(ce,{ref:this.upRef,direction:ae.TOP}),r.a.createElement(ce,{ref:this.rightRef,direction:ae.RIGHT})),r.a.createElement("div",{className:"arrow-space"},r.a.createElement("div",{className:"arrow-move-container"},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"arrow-move-wrapper"},l.map(function(t){return r.a.createElement(se,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})})),r.a.createElement("div",{className:"arrow-move-wrapper"},s.map(function(t){return r.a.createElement(se,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})})),r.a.createElement("div",{className:"arrow-move-wrapper"},c.map(function(t){return r.a.createElement(se,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})})),r.a.createElement("div",{className:"arrow-move-wrapper"},u.map(function(t){return r.a.createElement(se,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})}))))))}}]),t}(r.a.Component)),ue=(n(211),r.a.memo(function(e){var t=e.onScoreChange,n=e.webcam;return r.a.createElement("div",{className:"play-road"},r.a.createElement(le,{moveTime:5e3,arrows:x,onScoreChange:t,webcam:n}))})),me=(n(212),r.a.memo(function(e){var t=e.onStop;return r.a.createElement("div",{className:"back-button",onClick:t},"BACK")})),pe=(n(213),r.a.memo(function(e){var t=e.percentage;return r.a.createElement("div",{className:"happy-bar-container"},r.a.createElement("div",{className:"happy-bar-title"},"HAPPINESS"),r.a.createElement("div",{className:"happy-bar"},r.a.createElement("div",{className:"filler",style:{width:"".concat(t,"%")}})))})),de=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).webcamRef=r.a.createRef(),n.state={score:0,happy:20},n.handleScoreChange=function(e){return n.setState({score:n.state.score+e})},n.handleHappyChange=function(e){return n.setState({happy:e})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.level,a=t.onStop,o=this.state,i=o.happy;o.score;return r.a.createElement("div",{className:"play-container",onClick:function(){return e.handleHappyChange(Math.floor(100*Math.random()+1))}},r.a.createElement(h,null),r.a.createElement(ue,{level:n,onScoreChange:this.handleScoreChange,webcam:this.webcamRef}),r.a.createElement(M,{ref:this.webcamRef}),r.a.createElement(me,{onStop:a}),r.a.createElement(pe,{percentage:i}))}}]),t}(r.a.Component),fe=(n(214),n(22)),he=n.n(fe),ve=function(e){var t=e.onPlay;return r.a.createElement("div",{className:"level-navbar"},r.a.createElement("div",{className:"level",onClick:function(){return t(1)}},r.a.createElement("img",{src:he.a,alt:""})),r.a.createElement("div",{className:"level",onClick:function(){return t(1)}},r.a.createElement("img",{src:he.a,alt:""}),r.a.createElement("img",{src:he.a,alt:""})),r.a.createElement("div",{className:"level",onClick:function(){return t(2)}},r.a.createElement("img",{src:he.a,alt:""}),r.a.createElement("img",{src:he.a,alt:""}),r.a.createElement("img",{src:he.a,alt:""})))},ge=n(108),be=n.n(ge),ye=(n(215),function(e){var t=e.onPlay;return r.a.createElement("div",{className:"menu-container"},r.a.createElement("img",{src:be.a,alt:""}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"title"},"LEVELS"),r.a.createElement(ve,{onPlay:t}))}),Ee=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={level:j.UNSET},n.handleStartPlay=function(e){return n.setState({level:e})},n.handleStopPlay=function(){return n.setState({level:0})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.level;return r.a.createElement("div",{className:"page-layout"},r.a.createElement(f,null),e!==j.UNSET&&r.a.createElement(de,{level:e,onStop:this.handleStopPlay}),e===j.UNSET&&r.a.createElement(ye,{onPlay:this.handleStartPlay}))}}]),t}(r.a.Component);n(216);var we=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Ee,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(we,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},22:function(e,t,n){e.exports=n.p+"static/media/star.18db0e01.png"},98:function(e,t,n){e.exports=n.p+"static/media/bg-video.23b0e082.mp4"},99:function(e,t,n){e.exports=n.p+"static/media/upArrow.c8ac8c20.png"}},[[110,1,2]]]);
//# sourceMappingURL=main.e464a7c9.chunk.js.map