(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){e.exports=n.p+"static/media/topExplosion.7f0ea168.png"},101:function(e,t,n){e.exports=n.p+"static/media/bottomExplosion.95f0ab71.png"},102:function(e,t,n){e.exports=n.p+"static/media/leftExplosion.0385c4aa.png"},103:function(e,t,n){e.exports=n.p+"static/media/logo.815eb85e.png"},105:function(e,t,n){e.exports=n(215)},110:function(e,t,n){},111:function(e,t,n){},112:function(e,t,n){},113:function(e,t,n){},119:function(e,t){},121:function(e,t){},154:function(e,t){},155:function(e,t){},201:function(e,t){},202:function(e,t){},203:function(e,t){},204:function(e,t){},205:function(e,t){},207:function(e,t,n){},208:function(e,t,n){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},214:function(e,t,n){},215:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(93),i=n.n(o),c=(n(110),n(7)),s=n(9),l=n(12),u=n(10),m=n(11),p=(n(111),n(112),function(){return r.a.createElement("div",{className:"background-video"},r.a.createElement("iframe",{src:"https://www.youtube.com/embed/rRzxEiBLQCA?autoplay=1&controls=0&showinfo=0&autohide=1&start=47&loop=1",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("div",{className:"background-video-bg"}))}),d=(n(113),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).interval=null,n.state={time:0},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){e.setState({time:e.state.time+1})},1e3)}},{key:"render",value:function(){return r.a.createElement("div",{className:"play-time"},r.a.createElement("span",{className:"title"},"TIME"),r.a.createElement("span",{className:"time"},[(e=this.state.time)%3600/60,e%60].map(function(e){return"0".concat(Math.floor(e)).slice(-2)}).join(":")));var e}}]),t}(r.a.PureComponent)),f=n(13),h=n.n(f),v=n(19),g=n(25),y=n(37),b=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(){var e=Object(y.a)(n),t=e.video,a=e.overlay,r=e.isLoaded;if(t&&a&&r){var o=n.video.getBoundingClientRect(),i=o.width,c=o.height;n.overlay.width=i,n.overlay.height=c,n.props.onLoaded({mediaElement:t,overlay:a})}},n.onVideoRef=function(e){n.video=e,n.props.onVideoRef&&n.props.onVideoRef(),n.onChange()},n.onCanvasRef=function(e){n.overlay=e,n.onChange()},n.onPlay=function(){n.isLoaded=!0,n.onChange()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.srcObject;t&&this.props.srcObject!==t&&(this.video.srcObject=t)}},{key:"shouldComponentUpdate",value:function(e){return e.src!==this.props.src}},{key:"componentDidUpdate",value:function(){this.onChange()}},{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){return a.createElement("div",{style:{position:"relative"}},a.createElement("video",{muted:!0,autoPlay:!0,style:Object.assign({},this.props.videoStyle),ref:this.onVideoRef,onPlay:this.onPlay,src:this.props.src,className:"video-element"}),a.createElement("canvas",{style:{position:"absolute",top:0,left:0},ref:this.onCanvasRef}))}}]),t}(a.Component),w=(n(207),function e(){var t=this;Object(c.a)(this,e),this.promise=new Promise(function(e,n){t.reject=n,t.resolve=e})}),E=n(104),O={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right"},R={UNSET:0,EASY:1,MEDIUM:2,HARD:3},T=Object(E.a)(Array(500)),j=function(){var e=Math.random();return e<.25?O.UP:e<.5?O.DOWN:e<.75?O.LEFT:O.RIGHT},S=T.map(function(){return{type:j(),nextArrowStartTime:Math.max(2e3*Math.random(),500)}}),k=1e3,x=500,N=300,C=4,F=.01,D=.5,P=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={listFrames:[],faceDetectionOptions:new g.a,isFirstFaceDetected:!1},n.listComingDirection=[],n.directionId=0,n.loadFaceDetector=Object(v.a)(h.a.mark(function e(){var t;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=g.c.tinyFaceDetector).isLoaded||(console.log("Reload Model: ",t),t.loadFromUri("./models")),n.setState({isFaceDetectorLoaded:!0});case 3:case"end":return e.stop()}},e)})),n.runFaceRecognition=Object(v.a)(h.a.mark(function e(){var t,a,r,o,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,a=t.mediaElement,r=t.overlay,o=t.faceDetectionOptions,a&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,g.b(a,o).withFaceExpressions();case 5:(i=e.sent)?n.onReceivedNextFrame(i):n.setState({somethingDummy:Math.random()});case 7:case"end":return e.stop()}},e)})),n.onVideoRef=Object(v.a)(h.a.mark(function e(){var t;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:{}});case 3:t=e.sent,n.setState({srcObject:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n.setState({error:e.t0.toString()});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),n.checkLastMovingFrame=function(e,t){var a=n.state.listFrames;if(a.length<1)return!0;var r=a[a.length-1],o=r.x,i=r.y;return!(Math.abs(e-o)<F)&&!(Math.abs(t-i)<F)},n.checkDirectionWithTimeout=function(e,t){var a=new w,r=a.resolve,o=a.promise,i=++n.directionId;return setTimeout(function(){n.listComingDirection=n.listComingDirection.filter(function(e){return e.id!==i}),r({isValid:!1,happyValue:null})},t),n.listComingDirection.push({resolve:r,type:e,id:i}),o},n.onReceivedNextFrame=function(e){var t=e.detection,a=e.expressions.happy;a<D&&console.log("Unhappy!!! Rate: ".concat(100*a," %"));var r=t.box,o=r.x,i=r.y;if(n.checkLastMovingFrame(o,i)){var c=n.state.listFrames;if(c.length===C){var s=c[0],l=s.x,u=s.y,m=Math.abs(o-l),p=Math.abs(i-u),d=O.LEFT;m>p?o<l&&(d=O.RIGHT):d=i<u?O.UP:O.DOWN;var f=n.listComingDirection.filter(function(e){return e.type===d});f.length>0&&(f[0].resolve({isValid:!0,happyValue:a}),n.listComingDirection=n.listComingDirection.filter(function(e){return e.id!==f[0].id})),n.setState({listFrames:[{x:o,y:i}]})}else c.push({x:o,y:i}),n.setState({listFrames:c})}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"loadModels",value:function(){var e=Object(v.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([g.c.faceExpressionNet.loadFromUri("./models"),g.c.tinyFaceDetector.loadFromUri("./models")]);case 2:return e.next=4,this.loadFaceDetector();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.loadModels()}},{key:"componentDidUpdate",value:function(){this.runFaceRecognition()}},{key:"render",value:function(){var e=this;return this.state.error?a.createElement("div",{style:{background:"red",color:"white"}},a.createElement("h3",null," Error occured while requesting webcam access: "),a.createElement("p",null," ",this.state.error," ")):a.createElement("div",{className:"webcam-container"},a.createElement(b,{srcObject:this.state.srcObject,onLoaded:function(t){return e.setState(t)},onVideoRef:this.onVideoRef,onReceivedNextFrame:this.onReceivedNextFrame}))}}]),t}(a.Component),A=n(39),M=n(40),I=n(94),L=n.n(I),U=n(95),H=n.n(U),V=n(96),G=n.n(V),W=n(97),B=n.n(W),_=function e(t){var n=t.element,a=t.frames,r=t.duration,o=void 0===r?600:r,i=t.columns,s=t.rows,l=t.startingPosition,u=void 0===l?null:l,m=t.iterations,p=void 0===m?1/0:m;Object(c.a)(this,e),this.element=n,this.frames=a,this.duration=o/a,this.columns=i,this.rows=s,this.startingPosition=u,this.iterations=p,this.animateSprite=function(){var e=this.element,t=this.startingPosition,n=this.columns,a=this.rows,r=this.duration,o=this.iterations,i=document.querySelector(".".concat(e)),c=i.dataset.animationSrc,s=0,l=0,u=0;"bottom-right"===t&&(l=100,u=100),i.style.background="url(".concat(c,") ").concat(l,"% ").concat(u,"%"),i.style.backgroundSize="".concat(100*n,"% ").concat(100*a,"%"),requestAnimationFrame(function e(c){if(c-s<r)return void requestAnimationFrame(e);s=c;i.style.backgroundPosition="".concat(l,"% ").concat(u,"%");null===t?(l<100?l+=100/(n-1):(l=0,u>=100?(u=0,o&&o>0&&o--):u+=100/(a-1)),o>0&&requestAnimationFrame(e)):"bottom-right"===t&&(l>0?l-=100/(n-1):(l=100,u>0?u-=100/(a-1):(u=100,o&&o>0&&o--)),o>0&&requestAnimationFrame(e))})}},q=n(98),z=n.n(q),J=n(99),K=n.n(J),Q=n(100),Y=n.n(Q),$=n(101),X=n.n($),Z=n(102),ee=n.n(Z),te={TOP:"top",LEFT:"left",RIGHT:"right",BOTTOM:"bottom"},ne=80,ae={width:ne,height:ne},re={width:ne+80,height:ne+80,position:"relative",top:-(ne+20)},oe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getRotateAngle=function(){switch(n.props.direction){case te.TOP:return 180;case te.LEFT:return 90;case te.RIGHT:return-90;default:return 0}},n.getExplosionIcon=function(){switch(n.props.direction){case te.TOP:return Y.a;case te.LEFT:return ee.a;case te.RIGHT:return z.a;default:return X.a}},n.getRowOfSprite=function(){switch(n.props.direction){case te.TOP:return 7;case te.LEFT:case te.RIGHT:return 9;default:return 8}},n.boom=function(){n._animationOne.animateSprite()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._animationOne=new _({element:"image-".concat(this.props.direction),frames:60,columns:10,rows:this.getRowOfSprite(),iterations:1})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("img",{src:K.a,style:Object(M.a)({},ae,{transform:"rotate(".concat(this.getRotateAngle(),"deg)")})})),r.a.createElement("div",{style:re,className:"image-".concat(this.props.direction),"data-animation-src":this.getExplosionIcon()}))}}]),t}(a.Component),ie=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._onReachTop=Object(v.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.onReachTop();case 2:e.sent&&n.setState({scale:0});case 4:case"end":return e.stop()}},e)})),n.getImageSource=function(){switch(n.props.type){case O.UP:return L.a;case O.LEFT:return G.a;case O.RIGHT:return B.a;default:return H.a}},n.state={bottom:-ne,scale:1},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.isStart,r=n.distance,o=n.moveTime;a&&!e.isStart&&this.setState({bottom:r},function(){return setTimeout(t._onReachTop,o-500)})}},{key:"render",value:function(){var e=this.props.moveTime,t=this.state,n=t.bottom,a=t.scale;return r.a.createElement("img",{src:this.getImageSource(),alt:"up-icon",className:"arrow-item",style:{transition:"bottom ".concat(e/1e3,"s linear, opacity 0.2s, transform 0.2s"),bottom:n,transform:"scale(".concat(a,")"),opacity:a,width:ne,height:ne}})}}]),t}(r.a.Component),ce=(n(208),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).leftRef=r.a.createRef(),n.downRef=r.a.createRef(),n.upRef=r.a.createRef(),n.rightRef=r.a.createRef(),n._preProcessingData=function(){var e=n.props.arrows,t=0;return e.map(function(e,n){var a={id:n,type:e.type,timeoutStartTime:t};return t+=e.nextArrowStartTime,a})},n.start=function(){n.state.data.forEach(function(e){setTimeout(function(){return n.animateArrow(e)},e.timeoutStartTime)})},n.animateArrow=function(e){n.setState({isAnimatedMap:Object(M.a)({},n.state.isAnimatedMap,Object(A.a)({},e.id,!0))})},n.handleBoom=function(e){switch(e){case O.UP:n.upRef.current.boom();break;case O.DOWN:n.downRef.current.boom();break;case O.LEFT:n.leftRef.current.boom();break;case O.RIGHT:n.rightRef.current.boom()}},n.handleReachTop=function(){var e=Object(v.a)(h.a.mark(function e(t,a){var r,o,i,c,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Date.now(),e.next=3,n.props.webcam.current.checkDirectionWithTimeout(a,k);case 3:return o=e.sent,i=o.isValid,o.happyValue,i&&(c=Date.now(),(s=c-r)<=k/3||s>2*k/3?n.props.onScoreChange(N):n.props.onScoreChange(x),n.handleBoom(a)),e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.state={data:n._preProcessingData(n.props.arrows),isAnimatedMap:{}},setTimeout(function(){return n.forceUpdate()},100),setTimeout(n.start,500),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.data,a=t.isAnimatedMap,o=this.props.moveTime,i=document.getElementById("arrow-game"),c=n.filter(function(e){return e.type===O.UP}),s=n.filter(function(e){return e.type===O.DOWN}),l=n.filter(function(e){return e.type===O.LEFT}),u=n.filter(function(e){return e.type===O.RIGHT});return r.a.createElement("div",{className:"arrow-game-wrapper",id:"arrow-game"},r.a.createElement("div",{className:"arrow-holder-wrapper"},r.a.createElement(oe,{ref:this.leftRef,direction:te.LEFT}),r.a.createElement(oe,{ref:this.downRef,direction:te.BOTTOM}),r.a.createElement(oe,{ref:this.upRef,direction:te.TOP}),r.a.createElement(oe,{ref:this.rightRef,direction:te.RIGHT})),r.a.createElement("div",{className:"arrow-space"},r.a.createElement("div",{className:"arrow-move-container"},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"arrow-move-wrapper"},l.map(function(t){return r.a.createElement(ie,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})})),r.a.createElement("div",{className:"arrow-move-wrapper"},s.map(function(t){return r.a.createElement(ie,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})})),r.a.createElement("div",{className:"arrow-move-wrapper"},c.map(function(t){return r.a.createElement(ie,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})})),r.a.createElement("div",{className:"arrow-move-wrapper"},u.map(function(t){return r.a.createElement(ie,{key:t.id,type:t.type,isStart:!!a[t.id],moveTime:o,onReachTop:function(){return e.handleReachTop(t.id,t.type)},distance:i.clientHeight})}))))))}}]),t}(r.a.Component)),se=(n(209),r.a.memo(function(e){var t=e.onScoreChange,n=e.webcam;return r.a.createElement("div",{className:"play-road"},r.a.createElement(ce,{moveTime:5e3,arrows:S,onScoreChange:t,webcam:n}))})),le=(n(210),r.a.memo(function(e){var t=e.onStop;return r.a.createElement("div",{className:"back-button",onClick:t},"BACK")})),ue=(n(211),r.a.memo(function(e){var t=e.percentage;return r.a.createElement("div",{className:"happy-bar-container"},r.a.createElement("div",{className:"happy-bar-title"},"HAPPINESS"),r.a.createElement("div",{className:"happy-bar"},r.a.createElement("div",{className:"filler",style:{width:"".concat(t,"%")}})))})),me=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).webcamRef=r.a.createRef(),n.state={score:0,happy:20},n.handleScoreChange=function(e){return n.setState({score:n.state.score+e})},n.handleHappyChange=function(e){return n.setState({happy:e})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.level,a=t.onStop,o=this.state,i=o.happy;o.score;return r.a.createElement("div",{className:"play-container",onClick:function(){return e.handleHappyChange(Math.floor(100*Math.random()+1))}},r.a.createElement(d,null),r.a.createElement(se,{level:n,onScoreChange:this.handleScoreChange,webcam:this.webcamRef}),r.a.createElement(P,{ref:this.webcamRef}),r.a.createElement(le,{onStop:a}),r.a.createElement(ue,{percentage:i}))}}]),t}(r.a.Component),pe=(n(212),n(22)),de=n.n(pe),fe=function(e){var t=e.onPlay;return r.a.createElement("div",{className:"level-navbar"},r.a.createElement("div",{className:"level",onClick:function(){return t(1)}},r.a.createElement("img",{src:de.a,alt:""})),r.a.createElement("div",{className:"level",onClick:function(){return t(1)}},r.a.createElement("img",{src:de.a,alt:""}),r.a.createElement("img",{src:de.a,alt:""})),r.a.createElement("div",{className:"level",onClick:function(){return t(2)}},r.a.createElement("img",{src:de.a,alt:""}),r.a.createElement("img",{src:de.a,alt:""}),r.a.createElement("img",{src:de.a,alt:""})))},he=n(103),ve=n.n(he),ge=(n(213),function(e){var t=e.onPlay;return r.a.createElement("div",{className:"menu-container"},r.a.createElement("img",{src:ve.a,alt:""}),r.a.createElement("div",{className:"title"},"LEVELS"),r.a.createElement(fe,{onPlay:t}))}),ye=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={level:R.UNSET},n.handleStartPlay=function(e){return n.setState({level:e})},n.handleStopPlay=function(){return n.setState({level:0})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.level;return r.a.createElement("div",{className:"page-layout"},r.a.createElement(p,null),e!==R.UNSET&&r.a.createElement(me,{level:e,onStop:this.handleStopPlay}),e===R.UNSET&&r.a.createElement(ge,{onPlay:this.handleStartPlay}))}}]),t}(r.a.Component);n(214);var be=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(ye,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},22:function(e,t,n){e.exports=n.p+"static/media/star.18db0e01.png"},94:function(e,t,n){e.exports=n.p+"static/media/upArrow.c8ac8c20.png"},95:function(e,t,n){e.exports=n.p+"static/media/downArrow.ee80dd4b.png"},96:function(e,t,n){e.exports=n.p+"static/media/leftArrow.a0858f6e.png"},97:function(e,t,n){e.exports=n.p+"static/media/rightArrow.5e5705ec.png"},98:function(e,t,n){e.exports=n.p+"static/media/spritesheet.1f93086c.png"},99:function(e,t,n){e.exports=n.p+"static/media/itg_arrow_good_400x400.c3128bf8.png"}},[[105,1,2]]]);
//# sourceMappingURL=main.13faddab.chunk.js.map